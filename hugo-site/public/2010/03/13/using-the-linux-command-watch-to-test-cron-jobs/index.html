<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Using the Linux command &#39;Watch&#39; to test Cron jobs and more | DavidCraddock.net</title>
<meta name="keywords" content="">
<meta name="description" content="OK, so you have added a cron job that you want to perform a routine task every day at 6am. How do you test it?
You probably don&rsquo;t want to spend all night waiting for it to execute, and there&rsquo;s every chance that when it does execute, you won&rsquo;t be able to find out whether it is executing properly - the task might take 30 minutes to run, for example. So every time you debug it and want to test it again, you have to wait until 6am the following day.">
<meta name="author" content="Reorx">
<link rel="canonical" href="http://davidcraddock.net/2010/03/13/using-the-linux-command-watch-to-test-cron-jobs/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.97d99fcdd90c38f6e3343e959a97a0295b30f590730a4ece2347f7f24ad997d1.css" integrity="sha256-l9mfzdkMOPbjND6VmpegKVsw9ZBzCk7OI0f38krZl9E=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://davidcraddock.net/favicon.ico">
<link rel="apple-touch-icon" href="http://davidcraddock.net/apple-touch-icon.png">
<link rel="alternate" hreflang="en" href="http://davidcraddock.net/2010/03/13/using-the-linux-command-watch-to-test-cron-jobs/">
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Using the Linux command &#39;Watch&#39; to test Cron jobs and more | DavidCraddock.net" />
<meta name="twitter:description" content="OK, so you have added a cron job that you want to perform a routine task every day at 6am. How do you test it?
You probably don&rsquo;t want to spend all night waiting for it to execute, and there&rsquo;s every chance that when it does execute, you won&rsquo;t be able to find out whether it is executing properly - the task might take 30 minutes to run, for example. So every time you debug it and want to test it again, you have to wait until 6am the following day." />
<meta property="og:title" content="Using the Linux command &#39;Watch&#39; to test Cron jobs and more | DavidCraddock.net" />
<meta property="og:description" content="OK, so you have added a cron job that you want to perform a routine task every day at 6am. How do you test it?
You probably don&rsquo;t want to spend all night waiting for it to execute, and there&rsquo;s every chance that when it does execute, you won&rsquo;t be able to find out whether it is executing properly - the task might take 30 minutes to run, for example. So every time you debug it and want to test it again, you have to wait until 6am the following day." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://davidcraddock.net/2010/03/13/using-the-linux-command-watch-to-test-cron-jobs/" />
    <meta property="og:image" content="http://davidcraddock.net/cover.png"/>
<meta property="article:section" content="posts" />
  <meta property="article:published_time" content="2010-03-13T16:02:42&#43;00:00" />
  <meta property="article:modified_time" content="2010-03-13T16:02:42&#43;00:00" />


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://davidcraddock.net/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Using the Linux command 'Watch' to test Cron jobs and more",
      "item": "http://davidcraddock.net/2010/03/13/using-the-linux-command-watch-to-test-cron-jobs/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Using the Linux command 'Watch' to test Cron jobs and more | DavidCraddock.net",
  "name": "Using the Linux command \u0027Watch\u0027 to test Cron jobs and more",
  "description": "OK, so you have added a cron job that you want to perform a routine task every day at 6am. How do you test it?\nYou probably don\u0026rsquo;t want to spend all night waiting for it to execute, and there\u0026rsquo;s every chance that when it does execute, you won\u0026rsquo;t be able to find out whether it is executing properly - the task might take 30 minutes to run, for example. So every time you debug it and want to test it again, you have to wait until 6am the following day.",
  "keywords": [
    
  ],
  "wordCount" : "925",
  "inLanguage": "en",
  "datePublished": "2010-03-13T16:02:42Z",
  "dateModified": "2010-03-13T16:02:42Z",
  "author":[{
    "@type": "Person",
    "name": "Reorx"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://davidcraddock.net/2010/03/13/using-the-linux-command-watch-to-test-cron-jobs/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "DavidCraddock.net",
    "logo": {
      "@type": "ImageObject",
      "url": "http://davidcraddock.net/favicon.ico"
    }
  }
}
</script>
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary-bg: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list-page {
                background: var(--theme);
            }

            .list-page:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list-page:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

</head>

<body class=" type-posts kind-page layout-" id="top"><script data-no-instant>
function switchTheme(theme) {
  switch (theme) {
    case 'light':
      document.body.classList.remove('dark');
      break;
    case 'dark':
      document.body.classList.add('dark');
      break;
    
    default:
      if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
      }
  }
}

function isDarkTheme() {
  return document.body.className.includes("dark");
}

function getPrefTheme() {
  return localStorage.getItem("pref-theme");
}

function setPrefTheme(theme) {
  switchTheme(theme)
  localStorage.setItem("pref-theme", theme);
}

const toggleThemeCallbacks = {}
toggleThemeCallbacks['main'] = (isDark) => {
  
  if (isDark) {
    setPrefTheme('light');
  } else {
    setPrefTheme('dark');
  }
}




window.addEventListener('toggle-theme', function() {
  
  const isDark = isDarkTheme()
  for (const key in toggleThemeCallbacks) {
    toggleThemeCallbacks[key](isDark)
  }
});


function toggleThemeListener() {
  
  window.dispatchEvent(new CustomEvent('toggle-theme'));
}

</script>
<script>
  
  (function() {
    const defaultTheme = 'auto';
    const prefTheme = getPrefTheme();
    const theme = prefTheme ? prefTheme : defaultTheme;

    switchTheme(theme);
  })();
</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://davidcraddock.net/" accesskey="h" title="DavidCraddock.net (Alt + H)">DavidCraddock.net</a>
            <span class="logo-switches">
            </span>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main post">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://davidcraddock.net/">Home</a>&nbsp;Â»&nbsp;<a href="http://davidcraddock.net/posts/">Posts</a></div><h1 class="post-title">Using the Linux command &#39;Watch&#39; to test Cron jobs and more</h1>
    <div class="post-meta"><span class="meta-item">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select: text;"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select: text;"></rect><line x1="16" y1="2" x2="16" y2="6" style="user-select: text;"></line><line x1="8" y1="2" x2="8" y2="6" style="user-select: text;"></line><line x1="3" y1="10" x2="21" y2="10" style="user-select: text;"></line></svg>
  <span>2010-03-13</span></span><span class="meta-item">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text" style="user-select: text;"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" style="user-select: text;"></path><polyline points="14 2 14 8 20 8" style="user-select: text;"></polyline><line x1="16" y1="13" x2="8" y2="13" style="user-select: text;"></line><line x1="16" y1="17" x2="8" y2="17" style="user-select: text;"></line><polyline points="10 9 9 9 8 9" style="user-select: text;"></polyline></svg>
  <span>925 words</span></span><span class="meta-item">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><circle cx="12" cy="12" r="9"></circle><polyline points="12 7 12 12 15 15"></polyline></svg>
  <span>5 min</span></span>

      
      
    </div>
  </header> 

  <div class="post-content"><p>OK, so you have added a cron job that you want to perform a routine task every day at 6am. How do you test it?</p>
<p>You probably don&rsquo;t want to spend all night waiting for it to execute, and there&rsquo;s every chance that when it does execute, you won&rsquo;t be able to find out whether it is executing properly - the task might take 30 minutes to run, for example. So every time you debug it and want to test it again, you have to wait until 6am the following day.</p>
<p>So instead, configure that cron job to run a bit earlier than that, say in 10 minutes, and monitor the execution with a &lsquo;watch&rsquo; command, so you can see if it&rsquo;s doing what you want it to.</p>
<p>&lsquo;watch&rsquo; is a great command that will run a command at frequent intervals, by default, every 2 seconds. It&rsquo;s very useful when chained with the &lsquo;ps&rsquo; command, like the following:</p>
<p><code>watch 'ps aux | grep bash'</code></p>
<p>What that command will do, is continually monitor your server, and maintain an updated list that changes every 2 seconds, of every instance of the bash shell. When someone logs in and spawns a new bash shell, you&rsquo;ll know about it. When a cron&rsquo;d command runs that invokes a bash shell before executing a shellscript, you&rsquo;ll know about it. When someone writes a badly written shell script, and runs it invoking about 100 bash shells by accident, flooding your servers memory, you&rsquo;ll know about it.</p>
<p>OK so back to the cron example. Suppose I&rsquo;m testing a cronjob that should invoke a shell script that runs an rsync command. I just set the cron job to run in 5 minutes, then run this command:</p>
<p><code>watch 'ps aux | grep rsync'</code></p>
<p>Here is the result.. every single rsync command that is running on my server is displayed, and the list is updated every 2 seconds:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Every 2.0s: ps aux | grep rsync                                              Sat Mar 13 15:59:35 2010
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>root     16026  0.0  0.0   1752   480 ?        Ss   15:28   0:00 /bin/sh -c /opt/remote/rsync-matt/cr
</span></span><span style="display:flex;"><span>root     16027  0.0  0.0   1752   488 ?        S    15:28   0:00 /bin/sh /opt/remote/rsync-matt/crond
</span></span><span style="display:flex;"><span>root     16032  0.0  0.1   3632  1176 ?        S    15:28   0:00 rsync -avvz --remove-source-files -P
</span></span><span style="display:flex;"><span>root     16033  0.5  0.4   7308  4436 ?        R    15:28   0:09 ssh -l david someotherhost rsync --se
</span></span><span style="display:flex;"><span>root     16045  0.4  0.1   4152  1244 ?        S    15:28   0:07 rsync -avvz --remove-source-files -P
</span></span><span style="display:flex;"><span>root     18184  0.0  0.1   3176  1000 pts/2    R+   15:59   0:00 watch ps aux | grep rsync
</span></span><span style="display:flex;"><span>root     18197  0.0  0.0   3176   296 pts/2    S+   15:59   0:00 watch ps aux | grep rsync
</span></span><span style="display:flex;"><span>root     18198  0.0  0.0   1752   484 pts/2    S+   15:59   0:00 sh -c ps aux | grep rsync
</span></span></code></pre></div><p>Now I can see the time ticking away, and when the cron job is run, I can watch in real-time as it invokes rsync, and I can keep monitoring it to make sure all is running smoothly. This proves to be very useful when troubleshooting cron jobs.</p>
<p>You can also run two commands at the same time. You can actually tail a log file and combine it with the process monitoring like so:</p>
<p><code>watch 'tail /var/log/messages &amp;&amp; ps aux | grep rsync'</code></p>
<p>Try this yourself. It constantly prints out the last ten lines of the standard messages log file every two seconds, while monitoring the number of rsync processes running, and the commands used to invoke them. Tailor it to the cron&rsquo;d job you wish to test.</p>
<p>Watch can be used to keep an eye on other things also. If you&rsquo;re running a multi-user server and you want to see who&rsquo;s logged on at any one time, you can run this command:</p>
<p><code>watch 'echo CURRENT: &amp;&amp; who &amp;&amp; echo LASTLOGIN: &amp;&amp; lastlog | grep -v Never'</code></p>
<p>This chains 5 commands together. It will keep you updated with the current list of users logged in to your system, and it will also give you a constantly updated list of those users who have ever logged in before, with their last login time.</p>
<p>The following shows the output of that command above on a multi-user server I administrate, and will refresh with current information every 2 seconds until I exit it:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Every 2.0s: echo CURRENT: &amp;&amp; who &amp;&amp; echo LASTLOGIN: &amp;&amp; lastlog | grep -v Never                                                             Sat Mar 13 07:48:32 2010
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>CURRENT:
</span></span><span style="display:flex;"><span>mark     tty1         2010-02-23 11:08
</span></span><span style="display:flex;"><span>david    pts/2        2010-03-13 07:48 (wherever)
</span></span><span style="display:flex;"><span>mike     pts/4        2010-02-26 07:53 (wherever)
</span></span><span style="display:flex;"><span>mike     pts/5        2010-02-26 07:53 (wherever)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LASTLOGIN:
</span></span><span style="display:flex;"><span>Username         Port     From           Latest
</span></span><span style="display:flex;"><span>mark               pts/6    wherever      Thu Mar 11 23:24:36 -0800 2010
</span></span><span style="display:flex;"><span>mike               pts/0    wherever      Sat Mar 13 03:54:28 -0800 2010
</span></span><span style="display:flex;"><span>dan                pts/4    wherever      Fri Jan  1 08:46:29 -0800 2010
</span></span><span style="display:flex;"><span>sam                pts/1    wherever      Sat Jan 30 08:06:01 -0800 2010
</span></span><span style="display:flex;"><span>rei                pts/2    wherever      Thu Dec 10 11:45:39 -0800 2009
</span></span><span style="display:flex;"><span>david              pts/2    wherever      Sat Mar 13 07:48:05 -0800 2010
</span></span></code></pre></div><p>This shows that mark, david and mike are currently logged on. Mark is logged in on the server&rsquo;s physical monitor and keyboard(tty1). Everyone else is logged in remotely. Mike currently has two connections, or sessions, on the server. We can also see the list of users that have logged in before - ie: are active users, and when they last logged on. I immediately notice, for example, that rei hasn&rsquo;t logged in for 4 months and probably isn&rsquo;t using her account.</p>
<p>(Normally this command will also provide IP addresses and hostnames of where the users have logged on from, but I&rsquo;ve replaced those with &lsquo;wherever&rsquo; for privacy reasons)</p>
<p>So.. you can see that the &lsquo;watch&rsquo; command can be a useful window into what is happening, in real-time, on your servers.</p>

  </div>
  <img src="/images/me.jpg">

<div>
    <ul>
        <li><a href="/">Blog Posts</a></li>
        <li><a href="/my-home-network/">Home Network</a></li>
        <li><a href="/my-gaming-setup/">Gaming Setup</a></li>
        <li><a href="/my-mobile-laptop-setup/">Mobile Working Setup</a></li>
        <li><a href="/my-work-computer/">WFH Computer Setup</a></li>
        <li><a href="/my-bike/">Bike Setup</a></li>
        <li><a href="http://davidcraddocktutor.com">Software Career Tutoring</a></li>
        <li><a href="http://davidcraddockaudio.com">Music Industry Portfolio</a></li>
        <li><a href="https://github.com/wordswords">Github</a></li>
        <li><a href="https://linkedin.com/in/davidcraddock">LinkedIn</a></li>
        <li><a href="https://wordswords.github.io/dpc-resume/CV.html">CV/Resume</a></li>
    </ul>
</div>

  <footer class="post-footer">
<nav class="paginav">
  <a class="prev" href="http://davidcraddock.net/2010/03/18/my-minimal-vim-config/">
    <span class="title">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left" style="user-select: text;"><line x1="19" y1="12" x2="5" y2="12" style="user-select: text;"></line><polyline points="12 19 5 12 12 5" style="user-select: text;"></polyline></svg>&nbsp;Prev Page</span>
    <br>
    <span>My minimal VIM config</span>
  </a>
  <a class="next" href="http://davidcraddock.net/2010/03/10/changing-the-default-from-email-address-for-php/">
    <span class="title">Next Page&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select: text;"><line x1="5" y1="12" x2="19" y2="12" style="user-select: text;"></line><polyline points="12 5 19 12 12 19" style="user-select: text;"></polyline></svg>
    </span>
    <br>
    <span>Changing the default &#34;From:&#34; email address for emails sent via PHP on Linux</span>
  </a>
</nav>

  </footer>
    <div class="comments-separator"></div><div class="comments-box">
  <div id="disqus_thread"></div>
</div>

<script type="text/javascript">
  var disqus_config = function () {
    this.page.url = 'http:\/\/davidcraddock.net\/2010\/03\/13\/using-the-linux-command-watch-to-test-cron-jobs\/';  
    this.page.identifier = 'using-the-linux-command-watch-to-test-cron-jobs'; 
  };

  (function () {
    const disqus = window.DISQUS
    if (disqus) {
      
      
      disqus.reset({
        reload: true,
        config: disqus_config,
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = '//' + 'davidcraddocknet' + '.disqus.com/embed.js';
      s.defer = true;
      s.setAttribute('data-timestamp', +new Date());
      
      s.setAttribute('data-no-instant', '')
      d.head.appendChild(s);
    }
  })();
</script>

</article>
    </main>
    
<footer class="footer">
  <span>&copy; 2024 <a href="http://davidcraddock.net/">DavidCraddock.net</a></span><span style="display: inline-block; margin-left: 1em;">
    <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA</a>
  </span>
  <span style="display: inline-block; margin-left: 1em;">
    Powered by
    <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
    <a href="https://github.com/reorx/hugo-PaperModX/" rel="noopener" target="_blank">PaperModX</a>
  </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
    <path d="M12 6H0l6-6z" />
  </svg>
</a>

<script>
  (function() {
     
    const disableThemeToggle = '1' == '1';
    if (disableThemeToggle) {
      return;
    }

    let button = document.getElementById("theme-toggle")
    
    button.removeEventListener('click', toggleThemeListener)
    
    button.addEventListener('click', toggleThemeListener)
  })();
</script>

<script>
  (function () {
    let menu = document.getElementById('menu')
    if (menu) {
      menu.scrollLeft = localStorage.getItem("menu-scroll-position");
      menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
      }
    }

    const disableSmoothScroll = '' == '1';
    const enableInstantClick = '1' == '1';
    
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches || disableSmoothScroll || enableInstantClick) {
      return;
    }
    
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener("click", function (e) {
        e.preventDefault();
        var id = this.getAttribute("href").substr(1);
        document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
          behavior: "smooth"
        });
        if (id === "top") {
          history.replaceState(null, null, " ");
        } else {
          history.pushState(null, null, `#${id}`);
        }
      });
    });
  })();
</script>
<script>
  var mybutton = document.getElementById("top-link");
  window.onscroll = function () {
    if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
      mybutton.style.visibility = "visible";
      mybutton.style.opacity = "1";
    } else {
      mybutton.style.visibility = "hidden";
      mybutton.style.opacity = "0";
    }
  };
</script>
<script>
  if (window.scrollListeners) {
    
    for (const listener of scrollListeners) {
      window.removeEventListener('scroll', listener)
    }
  }
  window.scrollListeners = []
</script>



<script src="/js/medium-zoom.min.js" data-no-instant
></script>
<script>
  document.querySelectorAll('pre > code').forEach((codeblock) => {
    const container = codeblock.parentNode.parentNode;

    const copybutton = document.createElement('button');
    copybutton.classList.add('copy-code');
    copybutton.innerText = 'copy';

    function copyingDone() {
      copybutton.innerText = 'copied!';
      setTimeout(() => {
        copybutton.innerText = 'copy';
      }, 2000);
    }

    copybutton.addEventListener('click', (cb) => {
      if ('clipboard' in navigator) {
        navigator.clipboard.writeText(codeblock.textContent);
        copyingDone();
        return;
      }

      const range = document.createRange();
      range.selectNodeContents(codeblock);
      const selection = window.getSelection();
      selection.removeAllRanges();
      selection.addRange(range);
      try {
        document.execCommand('copy');
        copyingDone();
      } catch (e) { };
      selection.removeRange(range);
    });

    if (container.classList.contains("highlight")) {
      container.appendChild(copybutton);
    } else if (container.parentNode.firstChild == container) {
      
    } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
      
      codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
    } else {
      
      codeblock.parentNode.appendChild(copybutton);
    }
  });
</script>




<script>
  
  
  (function() {
    const enableTocScroll = '1' == '1'
    if (!enableTocScroll) {
      return
    }
    if (!document.querySelector('.toc')) {
      console.log('no toc found, ignore toc scroll')
      return
    }
    

    
    const scrollListeners = window.scrollListeners
    const headings = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id]');
    const activeClass = 'active';

    
    let activeHeading = headings[0];
    getLinkByHeading(activeHeading).classList.add(activeClass);

    const onScroll = () => {
      const passedHeadings = [];
      for (const h of headings) {
        
        if (getOffsetTop(h) < 5) {
          passedHeadings.push(h)
        } else {
          break;
        }
      }
      if (passedHeadings.length > 0) {
        newActiveHeading = passedHeadings[passedHeadings.length - 1];
      } else {
        newActiveHeading = headings[0];
      }
      if (activeHeading != newActiveHeading) {
        getLinkByHeading(activeHeading).classList.remove(activeClass);
        activeHeading = newActiveHeading;
        getLinkByHeading(activeHeading).classList.add(activeClass);
      }
    }

    let timer = null;
    const scrollListener = () => {
      if (timer !== null) {
        clearTimeout(timer)
      }
      timer = setTimeout(onScroll, 50)
    }
    window.addEventListener('scroll', scrollListener, false);
    scrollListeners.push(scrollListener)

    function getLinkByHeading(heading) {
      const id = encodeURI(heading.getAttribute('id')).toLowerCase();
      return document.querySelector(`.toc ul li a[href="#${id}"]`);
    }

    function getOffsetTop(heading) {
      if (!heading.getClientRects().length) {
        return 0;
      }
      let rect = heading.getBoundingClientRect();
      return rect.top
    }
  })();
  </script>
<script>
  mediumZoom('.entry-cover img');
  mediumZoom('.post-content img:not([no-zoom])');
</script>

<script src="/js/instantclick.min.js" data-no-instant
></script>
<script data-no-instant>
  
  
  
  
  
  
  InstantClick.init();
</script>
</body>

</html>
