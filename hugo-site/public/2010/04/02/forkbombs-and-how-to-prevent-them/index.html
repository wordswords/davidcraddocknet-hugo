<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Forkbombs and How to Prevent Them | DavidCraddock.net</title>
<meta name="keywords" content="">
<meta name="description" content="A forkbomb is a program or script that continually creates new copies of itself, that create new copies of themselves. It&rsquo;s usually a function that calls itself, and each time that function is called, it creates a new process to run the same function.
You end up with thousands of processes, all creating processes themselves, with an exponential growth. Soon it takes up all the resources of your server, and prevents anything else running on it.">
<meta name="author" content="Reorx">
<link rel="canonical" href="http://davidcraddock.net/2010/04/02/forkbombs-and-how-to-prevent-them/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.97d99fcdd90c38f6e3343e959a97a0295b30f590730a4ece2347f7f24ad997d1.css" integrity="sha256-l9mfzdkMOPbjND6VmpegKVsw9ZBzCk7OI0f38krZl9E=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://davidcraddock.net/favicon.ico">
<link rel="apple-touch-icon" href="http://davidcraddock.net/apple-touch-icon.png">
<link rel="alternate" hreflang="en" href="http://davidcraddock.net/2010/04/02/forkbombs-and-how-to-prevent-them/">
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Forkbombs and How to Prevent Them | DavidCraddock.net" />
<meta name="twitter:description" content="A forkbomb is a program or script that continually creates new copies of itself, that create new copies of themselves. It&rsquo;s usually a function that calls itself, and each time that function is called, it creates a new process to run the same function.
You end up with thousands of processes, all creating processes themselves, with an exponential growth. Soon it takes up all the resources of your server, and prevents anything else running on it." />
<meta property="og:title" content="Forkbombs and How to Prevent Them | DavidCraddock.net" />
<meta property="og:description" content="A forkbomb is a program or script that continually creates new copies of itself, that create new copies of themselves. It&rsquo;s usually a function that calls itself, and each time that function is called, it creates a new process to run the same function.
You end up with thousands of processes, all creating processes themselves, with an exponential growth. Soon it takes up all the resources of your server, and prevents anything else running on it." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://davidcraddock.net/2010/04/02/forkbombs-and-how-to-prevent-them/" />
    <meta property="og:image" content="http://davidcraddock.net/cover.png"/>
<meta property="article:section" content="posts" />
  <meta property="article:published_time" content="2010-04-02T03:50:37&#43;00:00" />
  <meta property="article:modified_time" content="2010-04-02T03:50:37&#43;00:00" />


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://davidcraddock.net/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Forkbombs and How to Prevent Them",
      "item": "http://davidcraddock.net/2010/04/02/forkbombs-and-how-to-prevent-them/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Forkbombs and How to Prevent Them | DavidCraddock.net",
  "name": "Forkbombs and How to Prevent Them",
  "description": "A forkbomb is a program or script that continually creates new copies of itself, that create new copies of themselves. It\u0026rsquo;s usually a function that calls itself, and each time that function is called, it creates a new process to run the same function.\nYou end up with thousands of processes, all creating processes themselves, with an exponential growth. Soon it takes up all the resources of your server, and prevents anything else running on it.",
  "keywords": [
    
  ],
  "wordCount" : "513",
  "inLanguage": "en",
  "datePublished": "2010-04-02T03:50:37Z",
  "dateModified": "2010-04-02T03:50:37Z",
  "author":[{
    "@type": "Person",
    "name": "Reorx"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://davidcraddock.net/2010/04/02/forkbombs-and-how-to-prevent-them/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "DavidCraddock.net",
    "logo": {
      "@type": "ImageObject",
      "url": "http://davidcraddock.net/favicon.ico"
    }
  }
}
</script>
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary-bg: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list-page {
                background: var(--theme);
            }

            .list-page:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list-page:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

</head>

<body class=" type-posts kind-page layout-" id="top"><script data-no-instant>
function switchTheme(theme) {
  switch (theme) {
    case 'light':
      document.body.classList.remove('dark');
      break;
    case 'dark':
      document.body.classList.add('dark');
      break;
    
    default:
      if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
      }
  }
}

function isDarkTheme() {
  return document.body.className.includes("dark");
}

function getPrefTheme() {
  return localStorage.getItem("pref-theme");
}

function setPrefTheme(theme) {
  switchTheme(theme)
  localStorage.setItem("pref-theme", theme);
}

const toggleThemeCallbacks = {}
toggleThemeCallbacks['main'] = (isDark) => {
  
  if (isDark) {
    setPrefTheme('light');
  } else {
    setPrefTheme('dark');
  }
}




window.addEventListener('toggle-theme', function() {
  
  const isDark = isDarkTheme()
  for (const key in toggleThemeCallbacks) {
    toggleThemeCallbacks[key](isDark)
  }
});


function toggleThemeListener() {
  
  window.dispatchEvent(new CustomEvent('toggle-theme'));
}

</script>
<script>
  
  (function() {
    const defaultTheme = 'auto';
    const prefTheme = getPrefTheme();
    const theme = prefTheme ? prefTheme : defaultTheme;

    switchTheme(theme);
  })();
</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://davidcraddock.net/" accesskey="h" title="DavidCraddock.net (Alt + H)">DavidCraddock.net</a>
            <span class="logo-switches">
            </span>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main post">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://davidcraddock.net/">Home</a>&nbsp;Â»&nbsp;<a href="http://davidcraddock.net/posts/">Posts</a></div><h1 class="post-title">Forkbombs and How to Prevent Them</h1>
    <div class="post-meta"><span class="meta-item">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select: text;"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select: text;"></rect><line x1="16" y1="2" x2="16" y2="6" style="user-select: text;"></line><line x1="8" y1="2" x2="8" y2="6" style="user-select: text;"></line><line x1="3" y1="10" x2="21" y2="10" style="user-select: text;"></line></svg>
  <span>2010-04-02</span></span><span class="meta-item">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text" style="user-select: text;"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" style="user-select: text;"></path><polyline points="14 2 14 8 20 8" style="user-select: text;"></polyline><line x1="16" y1="13" x2="8" y2="13" style="user-select: text;"></line><line x1="16" y1="17" x2="8" y2="17" style="user-select: text;"></line><polyline points="10 9 9 9 8 9" style="user-select: text;"></polyline></svg>
  <span>513 words</span></span><span class="meta-item">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><circle cx="12" cy="12" r="9"></circle><polyline points="12 7 12 12 15 15"></polyline></svg>
  <span>3 min</span></span>

      
      
    </div>
  </header> 

  <div class="post-content"><p>A forkbomb is a program or script that continually creates new copies of itself, that create new copies of themselves. It&rsquo;s usually a function that calls itself, and each time that function is called, it creates a new process to run the same function.</p>
<p>You end up with thousands of processes, all creating processes themselves, with an exponential growth. Soon it takes up all the resources of your server, and prevents anything else running on it.</p>
<p>Forkbombs are an example of a denial of service attack, because it completely locks up the server it&rsquo;s run on.</p>
<p>More worryingly, on a lot of Linux distributions, you can run a forkbomb as any user that has an account on that server. So for example, if you give your friend an account on your server, he can crash it/lock it up whenever he wants to, with the following shell script forkbomb:</p>
<p><code>:(){ :|:&amp; };: </code></p>
<p>Bad, huh?</p>
<p>Ubuntu server 9.10 is vulnerable to this shell script forkbomb. Run it on your linux server as any user, and it will lock it up.</p>
<p>This is something I wanted to fix right away on all my linux servers. Linux is meant to be multiuser, and it has a secure and structured permissions system allowing dozens of users to log in and do their work, at the same time. However when any one user can lock up the entire server, this is not good for a multiuser environment.</p>
<p>Fortunately, fixing this on ubuntu server 9.10 is quite simple. You limit the maximum number of running processes that any user can create. So the fork bomb runs, but hits this ceiling, and eventually stops without the administrator having to do anything.</p>
<p>As root, edit this file, and add the following line:</p>
<p>/etc/security/limits.conf</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>*               soft    nproc   35
</span></span></code></pre></div><p>This sets the maximum process cap for all users, to be 35. The root user isn&rsquo;t affected by this limit. This limit of 35 should be fine for remote servers that are not offering users gnome, kde, or any other graphical X interface. If you are expecting your users to be able to run applications like that, you may want to increase the limit to 50, and although this will increase the time forkbombs will take to exit, they should still exit without locking up your server.</p>
<p>Alternatively, you can setup an &lsquo;untrusted&rsquo; and &rsquo;trusted&rsquo; user groups, and assign that 35 limit to the untrusted users, giving trusted users access to the trusted group, which does not have that limit. Use these lines:</p>
<p>/etc/security/limits.conf</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>@untrusted               soft    nproc   35
</span></span><span style="display:flex;"><span>@trusted               soft    nproc   50
</span></span></code></pre></div><p>I&rsquo;ve tested these nproc limits on 8.10 and 9.10 ubuntu-server installs, but you should really test your own servers install, if possible, by forkbombing it yourself as a standard user, using the bash forkbomb above, once you&rsquo;ve applied the fix. The fix is effective as soon as you&rsquo;ve edited that file, but please note that you have to logout, and log back in again as a standard user before the new process cap is applied to your user account.</p>

  </div>
  <img src="/hugo-uploads/2024/8/3/me.jpg" />

<div>
    <ul>
        <li><a href="/">Blog Posts</a></li>
        <li><a href="/my-home-network/">Home Network</a></li>
        <li><a href="/my-gaming-setup/">Gaming Setup</a></li>
        <li><a href="/my-mobile-laptop-setup/">Mobile Working Setup</a></li>
        <li><a href="/my-work-computer/">WFH Computer Setup</a></li>
        <li><a href="/my-bike/">Bike Setup</a></li>
        <li><a href="http://davidcraddocktutor.com">Software Career Tutoring</a></li>
        <li><a href="http://davidcraddockaudio.com">Music Industry Portfolio</a></li>
        <li><a href="https://github.com/wordswords">Github</a></li>
        <li><a href="https://linkedin.com/in/davidcraddock">LinkedIn</a></li>
        <li><a href="https://wordswords.github.io/dpc-resume/CV.html">CV/Resume</a></li>
    </ul>
</div>

  <footer class="post-footer">
<nav class="paginav">
  <a class="prev" href="http://davidcraddock.net/2010/04/28/wordpress-html-edit-mode-inserts-br-tags-sometimes-when-you-add-a-carriage-return/">
    <span class="title">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left" style="user-select: text;"><line x1="19" y1="12" x2="5" y2="12" style="user-select: text;"></line><polyline points="12 19 5 12 12 5" style="user-select: text;"></polyline></svg>&nbsp;Prev Page</span>
    <br>
    <span>Wordpress HTML edit mode inserts BR tags sometimes when you add a carriage return..</span>
  </a>
  <a class="next" href="http://davidcraddock.net/2010/03/22/how-to-remove-nano-vim-and-other-editors-backup-files-out-of-a-directory-tree/">
    <span class="title">Next Page&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select: text;"><line x1="5" y1="12" x2="19" y2="12" style="user-select: text;"></line><polyline points="12 5 19 12 12 19" style="user-select: text;"></polyline></svg>
    </span>
    <br>
    <span>How to remove nano, vim and other editors&#39; backup files out of a directory tree</span>
  </a>
</nav>

  </footer>
    <div class="comments-separator"></div><div class="comments-box">
  <div id="disqus_thread"></div>
</div>

<script type="text/javascript">
  var disqus_config = function () {
    this.page.url = 'http:\/\/davidcraddock.net\/2010\/04\/02\/forkbombs-and-how-to-prevent-them\/';  
    this.page.identifier = 'forkbombs-and-how-to-prevent-them'; 
  };

  (function () {
    const disqus = window.DISQUS
    if (disqus) {
      
      
      disqus.reset({
        reload: true,
        config: disqus_config,
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = '//' + 'davidcraddocknet' + '.disqus.com/embed.js';
      s.defer = true;
      s.setAttribute('data-timestamp', +new Date());
      
      s.setAttribute('data-no-instant', '')
      d.head.appendChild(s);
    }
  })();
</script>

</article>
    </main>
    
<footer class="footer">
  <span>&copy; 2024 <a href="http://davidcraddock.net/">DavidCraddock.net</a></span><span style="display: inline-block; margin-left: 1em;">
    <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA</a>
  </span>
  <span style="display: inline-block; margin-left: 1em;">
    Powered by
    <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
    <a href="https://github.com/reorx/hugo-PaperModX/" rel="noopener" target="_blank">PaperModX</a>
  </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
    <path d="M12 6H0l6-6z" />
  </svg>
</a>

<script>
  (function() {
     
    const disableThemeToggle = '1' == '1';
    if (disableThemeToggle) {
      return;
    }

    let button = document.getElementById("theme-toggle")
    
    button.removeEventListener('click', toggleThemeListener)
    
    button.addEventListener('click', toggleThemeListener)
  })();
</script>

<script>
  (function () {
    let menu = document.getElementById('menu')
    if (menu) {
      menu.scrollLeft = localStorage.getItem("menu-scroll-position");
      menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
      }
    }

    const disableSmoothScroll = '' == '1';
    const enableInstantClick = '1' == '1';
    
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches || disableSmoothScroll || enableInstantClick) {
      return;
    }
    
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener("click", function (e) {
        e.preventDefault();
        var id = this.getAttribute("href").substr(1);
        document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
          behavior: "smooth"
        });
        if (id === "top") {
          history.replaceState(null, null, " ");
        } else {
          history.pushState(null, null, `#${id}`);
        }
      });
    });
  })();
</script>
<script>
  var mybutton = document.getElementById("top-link");
  window.onscroll = function () {
    if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
      mybutton.style.visibility = "visible";
      mybutton.style.opacity = "1";
    } else {
      mybutton.style.visibility = "hidden";
      mybutton.style.opacity = "0";
    }
  };
</script>
<script>
  if (window.scrollListeners) {
    
    for (const listener of scrollListeners) {
      window.removeEventListener('scroll', listener)
    }
  }
  window.scrollListeners = []
</script>



<script src="/js/medium-zoom.min.js" data-no-instant
></script>
<script>
  document.querySelectorAll('pre > code').forEach((codeblock) => {
    const container = codeblock.parentNode.parentNode;

    const copybutton = document.createElement('button');
    copybutton.classList.add('copy-code');
    copybutton.innerText = 'copy';

    function copyingDone() {
      copybutton.innerText = 'copied!';
      setTimeout(() => {
        copybutton.innerText = 'copy';
      }, 2000);
    }

    copybutton.addEventListener('click', (cb) => {
      if ('clipboard' in navigator) {
        navigator.clipboard.writeText(codeblock.textContent);
        copyingDone();
        return;
      }

      const range = document.createRange();
      range.selectNodeContents(codeblock);
      const selection = window.getSelection();
      selection.removeAllRanges();
      selection.addRange(range);
      try {
        document.execCommand('copy');
        copyingDone();
      } catch (e) { };
      selection.removeRange(range);
    });

    if (container.classList.contains("highlight")) {
      container.appendChild(copybutton);
    } else if (container.parentNode.firstChild == container) {
      
    } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
      
      codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
    } else {
      
      codeblock.parentNode.appendChild(copybutton);
    }
  });
</script>




<script>
  
  
  (function() {
    const enableTocScroll = '1' == '1'
    if (!enableTocScroll) {
      return
    }
    if (!document.querySelector('.toc')) {
      console.log('no toc found, ignore toc scroll')
      return
    }
    

    
    const scrollListeners = window.scrollListeners
    const headings = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id]');
    const activeClass = 'active';

    
    let activeHeading = headings[0];
    getLinkByHeading(activeHeading).classList.add(activeClass);

    const onScroll = () => {
      const passedHeadings = [];
      for (const h of headings) {
        
        if (getOffsetTop(h) < 5) {
          passedHeadings.push(h)
        } else {
          break;
        }
      }
      if (passedHeadings.length > 0) {
        newActiveHeading = passedHeadings[passedHeadings.length - 1];
      } else {
        newActiveHeading = headings[0];
      }
      if (activeHeading != newActiveHeading) {
        getLinkByHeading(activeHeading).classList.remove(activeClass);
        activeHeading = newActiveHeading;
        getLinkByHeading(activeHeading).classList.add(activeClass);
      }
    }

    let timer = null;
    const scrollListener = () => {
      if (timer !== null) {
        clearTimeout(timer)
      }
      timer = setTimeout(onScroll, 50)
    }
    window.addEventListener('scroll', scrollListener, false);
    scrollListeners.push(scrollListener)

    function getLinkByHeading(heading) {
      const id = encodeURI(heading.getAttribute('id')).toLowerCase();
      return document.querySelector(`.toc ul li a[href="#${id}"]`);
    }

    function getOffsetTop(heading) {
      if (!heading.getClientRects().length) {
        return 0;
      }
      let rect = heading.getBoundingClientRect();
      return rect.top
    }
  })();
  </script>
<script>
  mediumZoom('.entry-cover img');
  mediumZoom('.post-content img:not([no-zoom])');
</script>

<script src="/js/instantclick.min.js" data-no-instant
></script>
<script data-no-instant>
  
  
  
  
  
  
  InstantClick.init();
</script>
</body>

</html>
